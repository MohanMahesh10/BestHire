"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{58018:function(e,t,n){var l,i,r,o,s,a,u,p,d,c,h,f,m,g,y,C,v,E,O,I,A,_,T,S,P,b,R,N,w,x,M,D,L,q,U,G,H,j,B,F,V,k,Y,K,J,$,W,z,X,Q;n.d(t,{GoogleGenAI:function(){return to}});/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Z{}function ee(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error(`Key '${n}' not found in valueMap.`)})}function et(e,t,n){for(let l=0;l<t.length-1;l++){let i=t[l];if(i.endsWith("[]")){let r=i.slice(0,-2);if(!(r in e)){if(Array.isArray(n))e[r]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${i}`)}if(Array.isArray(e[r])){let i=e[r];if(Array.isArray(n))for(let e=0;e<i.length;e++){let r=i[e];et(r,t.slice(l+1),n[e])}else for(let e of i)et(e,t.slice(l+1),n)}return}if(i.endsWith("[0]")){let r=i.slice(0,-3);r in e||(e[r]=[{}]);let o=e[r];et(o[0],t.slice(l+1),n);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let l=t[t.length-1],i=e[l];if(void 0!==i){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===i)return;if("object"==typeof i&&"object"==typeof n&&null!==i&&null!==n)Object.assign(i,n);else throw Error(`Cannot set value for an existing key. Key: ${l}`)}else e[l]=n}function en(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;let l=t[n];if(l.endsWith("[]")){let i=l.slice(0,-2);if(!(i in e))return;{let l=e[i];if(!Array.isArray(l))return;return l.map(e=>en(e,t.slice(n+1)))}}e=e[l]}return e}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function el(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;{let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function ei(e,t){let n=el(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function er(e,t){if(null==t)throw Error("PartUnion is required");if("object"==typeof t)return t;if("string"==typeof t)return{text:t};throw Error(`Unsupported part type: ${typeof t}`)}function eo(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw Error("PartListUnion is required");return Array.isArray(t)?t.map(t=>er(e,t)):[er(e,t)]}function es(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function ea(e){return null!=e&&(null==e||"object"!=typeof e||!("functionCall"in e))}function eu(e){return!(null==e||Array.isArray(e)&&0===e.length)&&e.every(ea)}function ep(e,t){if(null==t)throw Error("ContentUnion is required");return es(t)?t:ea(t)?{role:"user",parts:eo(e,t)}:{role:"model",parts:eo(e,t)}}function ed(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(t=>{let n=ep(e,t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]});if(e.isVertexAI()){let n=ep(e,t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(t=>ep(e,t)):[ep(e,t)]}function ec(e,t,n){0!==n.length&&(eu(n)?t.push({role:"user",parts:eo(e,n)}):t.push({role:"model",parts:eo(e,n)}),n.length=0)}function eh(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw Error("contents are required");if(!Array.isArray(t))return[ep(e,t)];let n=[],l=[];for(let i of t)if(es(i))ec(e,n,l),n.push(i);else if("string"!=typeof i&&("object"!=typeof i||Array.isArray(i))){if(Array.isArray(i))ec(e,n,l),n.push({role:"user",parts:eo(e,i)});else throw Error(`Unsupported content type: ${typeof i}`)}else ea(i)===eu(l)||(ec(e,n,l),l.length=0),l.push(i);return ec(e,n,l),n}function ef(e,t){return!function e(t,n){if(!t.isVertexAI()&&("title"in n&&delete n.title,"default"in n))throw Error("Default value is not supported in the response schema for the Gemini API.");if("anyOf"in n){if(!t.isVertexAI())throw Error("AnyOf is not supported in the response schema for the Gemini API.");if(void 0!==n.anyOf)for(let l of n.anyOf)e(t,l)}}(e,t),t}function em(e,t){if("object"==typeof t&&"voiceConfig"in t)return t;if("string"==typeof t)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw Error(`Unsupported speechConfig type: ${typeof t}`)}function eg(e,t){if(!Array.isArray(t))throw Error("tool is required and must be an array of Tools");return t}function ey(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,l=1){let i=!t.startsWith(`${n}/`)&&t.split("/").length===l;if(e.isVertexAI())return t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t;return i?`${n}/${t}`:t}(e,t,"cachedContents")}function eC(e,t){if("string"!=typeof t)throw Error("fromImageBytes must be a string");return t}(b=l||(l={})).PAGED_ITEM_BATCH_JOBS="batchJobs",b.PAGED_ITEM_MODELS="models",b.PAGED_ITEM_TUNING_JOBS="tuningJobs",b.PAGED_ITEM_FILES="files",b.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class ev{constructor(e,t,n,l){this.pageInternal=[],this.requestInternal=t,this.init(e,n,l)}init(e,t,n){var l,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let r={config:{}};(r=n?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!==(i=null===(l=r.config)||void 0===l?void 0:l.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)!==void 0}}(R=i||(i={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",R.OUTCOME_OK="OUTCOME_OK",R.OUTCOME_FAILED="OUTCOME_FAILED",R.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(N=r||(r={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",N.PYTHON="PYTHON",(w=o||(o={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",w.STRING="STRING",w.NUMBER="NUMBER",w.INTEGER="INTEGER",w.BOOLEAN="BOOLEAN",w.ARRAY="ARRAY",w.OBJECT="OBJECT",(x=s||(s={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",x.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",x.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",x.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",x.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",x.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(M=a||(a={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",M.SEVERITY="SEVERITY",M.PROBABILITY="PROBABILITY",(D=u||(u={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",D.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",D.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",D.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",D.BLOCK_NONE="BLOCK_NONE",D.OFF="OFF",(L=p||(p={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",L.MODE_DYNAMIC="MODE_DYNAMIC",(q=d||(d={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",q.STOP="STOP",q.MAX_TOKENS="MAX_TOKENS",q.SAFETY="SAFETY",q.RECITATION="RECITATION",q.OTHER="OTHER",q.BLOCKLIST="BLOCKLIST",q.PROHIBITED_CONTENT="PROHIBITED_CONTENT",q.SPII="SPII",q.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",(U=c||(c={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",U.NEGLIGIBLE="NEGLIGIBLE",U.LOW="LOW",U.MEDIUM="MEDIUM",U.HIGH="HIGH",(G=h||(h={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",G.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",G.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",G.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",G.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(H=f||(f={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",H.SAFETY="SAFETY",H.OTHER="OTHER",H.BLOCKLIST="BLOCKLIST",H.PROHIBITED_CONTENT="PROHIBITED_CONTENT",(j=m||(m={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",j.ACTIVE="ACTIVE",j.ERROR="ERROR",(B=g||(g={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",B.MODE_DYNAMIC="MODE_DYNAMIC",(F=y||(y={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",F.AUTO="AUTO",F.ANY="ANY",F.NONE="NONE",(V=C||(C={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",V.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",V.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",V.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(k=v||(v={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",k.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",k.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",k.BLOCK_NONE="BLOCK_NONE",(Y=E||(E={})).DONT_ALLOW="DONT_ALLOW",Y.ALLOW_ADULT="ALLOW_ADULT",Y.ALLOW_ALL="ALLOW_ALL",(K=O||(O={})).auto="auto",K.en="en",K.ja="ja",K.ko="ko",K.hi="hi",(J=I||(I={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",J.PROCESSING="PROCESSING",J.ACTIVE="ACTIVE",J.FAILED="FAILED",($=A||(A={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",$.UPLOADED="UPLOADED",$.GENERATED="GENERATED",(W=_||(_={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",W.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",W.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",W.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",W.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(z=T||(T={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",z.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",z.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",z.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(X=S||(S={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",X.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",X.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",X.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(Q=P||(P={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",Q.TEXT="TEXT",Q.IMAGE="IMAGE",Q.AUDIO="AUDIO";class eE{get text(){var e,t,n,l,i,r,o,s;if((null===(l=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===l?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1,p=[];for(let e of null!==(s=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)&&void 0!==s?s:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&(null!==n||void 0!==n)&&p.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,a+=e.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0}get functionCalls(){var e,t,n,l,i,r,o,s;if((null===(l=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===l?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let a=null===(s=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==a?void 0:a.length)!==0)return a}get executableCode(){var e,t,n,l,i,r,o,s,a;if((null===(l=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===l?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null===(s=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code}get codeExecutionResult(){var e,t,n,l,i,r,o,s,a;if((null===(l=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===l?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null===(s=null===(o=null===(r=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===r?void 0:r.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output}}class eO{}class eI{}class eA{}class e_{}class eT{}class eS{}class eP{}class eb{constructor(e){let t={};for(let n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class eR{}/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eN extends Z{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ev(l.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["model"],ei(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],function(e,t,n){let l=en(t,["ttl"]);void 0!==n&&null!=l&&et(n,["ttl"],l);let i=en(t,["expireTime"]);void 0!==n&&null!=i&&et(n,["expireTime"],i);let r=en(t,["displayName"]);void 0!==n&&null!=r&&et(n,["displayName"],r);let o=en(t,["contents"]);void 0!==n&&null!=o&&(Array.isArray(o)?et(n,["contents"],eh(e,eh(e,o).map(t=>ex(e,t)))):et(n,["contents"],eh(e,o)));let s=en(t,["systemInstruction"]);void 0!==n&&null!=s&&et(n,["systemInstruction"],ex(e,ep(e,s)));let a=en(t,["tools"]);void 0!==n&&null!=a&&(Array.isArray(a)?et(n,["tools"],a.map(e=>(function(e,t){let n={},l=en(t,["functionDeclarations"]);null!=l&&(Array.isArray(l)?et(n,["functionDeclarations"],l.map(e=>(function(e,t){let n={},l=en(t,["response"]);null!=l&&et(n,["response"],function(e,t){let n={},l=en(t,["example"]);null!=l&&et(n,["example"],l);let i=en(t,["pattern"]);null!=i&&et(n,["pattern"],i);let r=en(t,["minimum"]);null!=r&&et(n,["minimum"],r);let o=en(t,["default"]);null!=o&&et(n,["default"],o);let s=en(t,["anyOf"]);null!=s&&et(n,["anyOf"],s);let a=en(t,["maxLength"]);null!=a&&et(n,["maxLength"],a);let u=en(t,["title"]);null!=u&&et(n,["title"],u);let p=en(t,["minLength"]);null!=p&&et(n,["minLength"],p);let d=en(t,["minProperties"]);null!=d&&et(n,["minProperties"],d);let c=en(t,["maximum"]);null!=c&&et(n,["maximum"],c);let h=en(t,["maxProperties"]);null!=h&&et(n,["maxProperties"],h);let f=en(t,["description"]);null!=f&&et(n,["description"],f);let m=en(t,["enum"]);null!=m&&et(n,["enum"],m);let g=en(t,["format"]);null!=g&&et(n,["format"],g);let y=en(t,["items"]);null!=y&&et(n,["items"],y);let C=en(t,["maxItems"]);null!=C&&et(n,["maxItems"],C);let v=en(t,["minItems"]);null!=v&&et(n,["minItems"],v);let E=en(t,["nullable"]);null!=E&&et(n,["nullable"],E);let O=en(t,["properties"]);null!=O&&et(n,["properties"],O);let I=en(t,["propertyOrdering"]);null!=I&&et(n,["propertyOrdering"],I);let A=en(t,["required"]);null!=A&&et(n,["required"],A);let _=en(t,["type"]);return null!=_&&et(n,["type"],_),n}(0,l));let i=en(t,["description"]);null!=i&&et(n,["description"],i);let r=en(t,["name"]);null!=r&&et(n,["name"],r);let o=en(t,["parameters"]);return null!=o&&et(n,["parameters"],o),n})(0,e))):et(n,["functionDeclarations"],l));let i=en(t,["retrieval"]);null!=i&&et(n,["retrieval"],i);let r=en(t,["googleSearch"]);null!=r&&et(n,["googleSearch"],{});let o=en(t,["googleSearchRetrieval"]);null!=o&&et(n,["googleSearchRetrieval"],function(e,t){let n={},l=en(t,["dynamicRetrievalConfig"]);return null!=l&&et(n,["dynamicRetrievalConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["dynamicThreshold"]);return null!=i&&et(n,["dynamicThreshold"],i),n}(0,l)),n}(0,o));let s=en(t,["codeExecution"]);return null!=s&&et(n,["codeExecution"],s),n})(0,e))):et(n,["tools"],a));let u=en(t,["toolConfig"]);return void 0!==n&&null!=u&&et(n,["toolConfig"],function(e,t){let n={},l=en(t,["functionCallingConfig"]);return null!=l&&et(n,["functionCallingConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["allowedFunctionNames"]);return null!=i&&et(n,["allowedFunctionNames"],i),n}(0,l)),n}(0,u)),{}}(e,i,n)),n}(this.apiClient,e);return l=ee("cachedContents",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=eD(this.apiClient,e);return t})}{let t=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["model"],ei(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],function(e,t,n){let l=en(t,["ttl"]);void 0!==n&&null!=l&&et(n,["ttl"],l);let i=en(t,["expireTime"]);void 0!==n&&null!=i&&et(n,["expireTime"],i);let r=en(t,["displayName"]);void 0!==n&&null!=r&&et(n,["displayName"],r);let o=en(t,["contents"]);void 0!==n&&null!=o&&(Array.isArray(o)?et(n,["contents"],eh(e,eh(e,o).map(t=>ew(e,t)))):et(n,["contents"],eh(e,o)));let s=en(t,["systemInstruction"]);void 0!==n&&null!=s&&et(n,["systemInstruction"],ew(e,ep(e,s)));let a=en(t,["tools"]);void 0!==n&&null!=a&&(Array.isArray(a)?et(n,["tools"],a.map(e=>(function(e,t){let n={},l=en(t,["functionDeclarations"]);if(null!=l&&(Array.isArray(l)?et(n,["functionDeclarations"],l.map(e=>(function(e,t){let n={};if(void 0!==en(t,["response"]))throw Error("response parameter is not supported in Gemini API.");let l=en(t,["description"]);null!=l&&et(n,["description"],l);let i=en(t,["name"]);null!=i&&et(n,["name"],i);let r=en(t,["parameters"]);return null!=r&&et(n,["parameters"],r),n})(0,e))):et(n,["functionDeclarations"],l)),void 0!==en(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=en(t,["googleSearch"]);null!=i&&et(n,["googleSearch"],{});let r=en(t,["googleSearchRetrieval"]);null!=r&&et(n,["googleSearchRetrieval"],function(e,t){let n={},l=en(t,["dynamicRetrievalConfig"]);return null!=l&&et(n,["dynamicRetrievalConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["dynamicThreshold"]);return null!=i&&et(n,["dynamicThreshold"],i),n}(0,l)),n}(0,r));let o=en(t,["codeExecution"]);return null!=o&&et(n,["codeExecution"],o),n})(0,e))):et(n,["tools"],a));let u=en(t,["toolConfig"]);return void 0!==n&&null!=u&&et(n,["toolConfig"],function(e,t){let n={},l=en(t,["functionCallingConfig"]);return null!=l&&et(n,["functionCallingConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["allowedFunctionNames"]);return null!=i&&et(n,["allowedFunctionNames"],i),n}(0,l)),n}(0,u)),{}}(e,i,n)),n}(this.apiClient,e);return l=ee("cachedContents",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=eM(this.apiClient,e);return t})}}async get(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("{name}",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=eD(this.apiClient,e);return t})}{let t=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("{name}",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=eM(this.apiClient,e);return t})}}async delete(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("{name}",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{var t;let n=(this.apiClient,{}),l=new eT;return Object.assign(l,n),l})}{let t=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("{name}",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{var t;let n=(this.apiClient,{}),l=new eT;return Object.assign(l,n),l})}}async update(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],function(e,t,n){let l=en(t,["ttl"]);void 0!==n&&null!=l&&et(n,["ttl"],l);let i=en(t,["expireTime"]);return void 0!==n&&null!=i&&et(n,["expireTime"],i),{}}(0,i,n)),n}(this.apiClient,e);return l=ee("{name}",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=eD(this.apiClient,e);return t})}{let t=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","name"],ey(e,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],function(e,t,n){let l=en(t,["ttl"]);void 0!==n&&null!=l&&et(n,["ttl"],l);let i=en(t,["expireTime"]);return void 0!==n&&null!=i&&et(n,["expireTime"],i),{}}(0,i,n)),n}(this.apiClient,e);return l=ee("{name}",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=eM(this.apiClient,e);return t})}}async listInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["config"]);return null!=l&&et(n,["config"],function(e,t,n){let l=en(t,["pageSize"]);void 0!==n&&null!=l&&et(n,["_query","pageSize"],l);let i=en(t,["pageToken"]);return void 0!==n&&null!=i&&et(n,["_query","pageToken"],i),{}}(0,l,n)),n}(this.apiClient,e);return l=ee("cachedContents",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["nextPageToken"]);null!=l&&et(n,["nextPageToken"],l);let i=en(t,["cachedContents"]);return null!=i&&(Array.isArray(i)?et(n,["cachedContents"],i.map(t=>eD(e,t))):et(n,["cachedContents"],i)),n}(this.apiClient,e),n=new eS;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["config"]);return null!=l&&et(n,["config"],function(e,t,n){let l=en(t,["pageSize"]);void 0!==n&&null!=l&&et(n,["_query","pageSize"],l);let i=en(t,["pageToken"]);return void 0!==n&&null!=i&&et(n,["_query","pageToken"],i),{}}(0,l,n)),n}(this.apiClient,e);return l=ee("cachedContents",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["nextPageToken"]);null!=l&&et(n,["nextPageToken"],l);let i=en(t,["cachedContents"]);return null!=i&&(Array.isArray(i)?et(n,["cachedContents"],i.map(t=>eM(e,t))):et(n,["cachedContents"],i)),n}(this.apiClient,e),n=new eS;return Object.assign(n,t),n})}}}function ew(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={};if(void 0!==en(t,["videoMetadata"]))throw Error("videoMetadata parameter is not supported in Gemini API.");let l=en(t,["thought"]);null!=l&&et(n,["thought"],l);let i=en(t,["codeExecutionResult"]);null!=i&&et(n,["codeExecutionResult"],i);let r=en(t,["executableCode"]);null!=r&&et(n,["executableCode"],r);let o=en(t,["fileData"]);null!=o&&et(n,["fileData"],o);let s=en(t,["functionCall"]);null!=s&&et(n,["functionCall"],s);let a=en(t,["functionResponse"]);null!=a&&et(n,["functionResponse"],a);let u=en(t,["inlineData"]);null!=u&&et(n,["inlineData"],u);let p=en(t,["text"]);return null!=p&&et(n,["text"],p),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function ex(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={},l=en(t,["videoMetadata"]);null!=l&&et(n,["videoMetadata"],l);let i=en(t,["thought"]);null!=i&&et(n,["thought"],i);let r=en(t,["codeExecutionResult"]);null!=r&&et(n,["codeExecutionResult"],r);let o=en(t,["executableCode"]);null!=o&&et(n,["executableCode"],o);let s=en(t,["fileData"]);null!=s&&et(n,["fileData"],s);let a=en(t,["functionCall"]);null!=a&&et(n,["functionCall"],a);let u=en(t,["functionResponse"]);null!=u&&et(n,["functionResponse"],u);let p=en(t,["inlineData"]);null!=p&&et(n,["inlineData"],p);let d=en(t,["text"]);return null!=d&&et(n,["text"],d),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function eM(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["name"],l);let i=en(t,["displayName"]);null!=i&&et(n,["displayName"],i);let r=en(t,["model"]);null!=r&&et(n,["model"],r);let o=en(t,["createTime"]);null!=o&&et(n,["createTime"],o);let s=en(t,["updateTime"]);null!=s&&et(n,["updateTime"],s);let a=en(t,["expireTime"]);null!=a&&et(n,["expireTime"],a);let u=en(t,["usageMetadata"]);return null!=u&&et(n,["usageMetadata"],u),n}function eD(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["name"],l);let i=en(t,["displayName"]);null!=i&&et(n,["displayName"],i);let r=en(t,["model"]);null!=r&&et(n,["model"],r);let o=en(t,["createTime"]);null!=o&&et(n,["createTime"],o);let s=en(t,["updateTime"]);null!=s&&et(n,["updateTime"],s);let a=en(t,["expireTime"]);null!=a&&et(n,["expireTime"],a);let u=en(t,["usageMetadata"]);return null!=u&&et(n,["usageMetadata"],u),n}function eL(e){return this instanceof eL?(this.v=e,this):new eL(e)}function eq(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var l,i=n.apply(e,t||[]),r=[];return l=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),l[Symbol.asyncIterator]=function(){return this},l;function o(e,t){i[e]&&(l[e]=function(t){return new Promise(function(n,l){r.push([e,t,n,l])>1||s(e,t)})},t&&(l[e]=t(l[e])))}function s(e,t){try{var n;(n=i[e](t)).value instanceof eL?Promise.resolve(n.value.v).then(a,u):p(r[0][2],n)}catch(e){p(r[0][3],e)}}function a(e){s("next",e)}function u(e){s("throw",e)}function p(e,t){e(t),r.shift(),r.length&&s(r[0][0],r[0][1])}}function eU(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],l=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&l>=e.length&&(e=void 0),{value:e&&e[l++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},l("next"),l("throw"),l("return"),t[Symbol.asyncIterator]=function(){return this},t);function l(n){t[n]=e[n]&&function(t){return new Promise(function(l,i){!function(e,t,n,l){Promise.resolve(l).then(function(t){e({value:t,done:n})},t)}(l,i,(t=e[n](t)).done,t.value)})}}}function eG(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length||void 0!==t.text&&""===t.text)return!1;return!0}"function"==typeof SuppressedError&&SuppressedError;class eH{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new ej(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}class ej{constructor(e,t,n,l={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=l,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){if("user"!==e[0].role)throw Error("History must start with a user turn.");for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(i)}async sendMessage(e){var t;await this.sendPromise;let n=ep(this.apiClient,e.message),l=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t;let i=await l,r=null===(t=null===(e=i.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content;this.recordHistory(n,r?[r]:[])})(),await this.sendPromise,l}async sendMessageStream(e){var t;await this.sendPromise;let n=ep(this.apiClient,e.message),l=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=l.then(()=>void 0);let i=await l,r=this.processStreamResponse(i,n);return r}getHistory(e=!1){return e?function(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,l=0,i=e[0];for(;l<n;)if("user"===e[l].role)i=e[l],l++;else{let r=[],o=!0;for(;l<n&&"model"===e[l].role;)r.push(e[l]),o&&!eG(e[l])&&(o=!1),l++;o&&(t.push(i),t.push(...r))}return t}(this.history):this.history}processStreamResponse(e,t){var n,l;return eq(this,arguments,function*(){var i,r,o,s;let a=[];try{for(var u,p=!0,d=eU(e);!(i=(u=yield eL(d.next())).done);p=!0){if(s=u.value,p=!1,/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&eG(n)}(s)){let e=null===(l=null===(n=s.candidates)||void 0===n?void 0:n[0])||void 0===l?void 0:l.content;void 0!==e&&a.push(e)}yield yield eL(s)}}catch(e){r={error:e}}finally{try{!p&&!i&&(o=d.return)&&(yield eL(o.call(d)))}finally{if(r)throw r.error}}this.recordHistory(t,a)})}recordHistory(e,t){let n=[];t.length>0&&t.every(e=>"model"===e.role)?n=t:n.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...n)}}/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eB extends Z{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e)}async generateContentInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=e$(this.apiClient,e);return l=ee("{model}:generateContent",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=eQ(this.apiClient,e),n=new eE;return Object.assign(n,t),n})}{let t=eJ(this.apiClient,e);return l=ee("{model}:generateContent",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=eX(this.apiClient,e),n=new eE;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=e$(this.apiClient,e);l=ee("{model}:streamGenerateContent?alt=sse",n._url),i=n._query,delete n.config,delete n._url,delete n._query;let r=this.apiClient;return r.requestStream({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(function(e){return eq(this,arguments,function*(){var t,n,l,i;try{for(var o,s=!0,a=eU(e);!(t=(o=yield eL(a.next())).done);s=!0){i=o.value,s=!1;let e=eQ(r,i),t=new eE;Object.assign(t,e),yield yield eL(t)}}catch(e){n={error:e}}finally{try{!s&&!t&&(l=a.return)&&(yield eL(l.call(a)))}finally{if(n)throw n.error}}})})}{let t=eJ(this.apiClient,e);l=ee("{model}:streamGenerateContent?alt=sse",t._url),i=t._query,delete t.config,delete t._url,delete t._query;let r=this.apiClient;return r.requestStream({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(function(e){return eq(this,arguments,function*(){var t,n,l,i;try{for(var o,s=!0,a=eU(e);!(t=(o=yield eL(a.next())).done);s=!0){i=o.value,s=!1;let e=eX(r,i),t=new eE;Object.assign(t,e),yield yield eL(t)}}catch(e){n={error:e}}finally{try{!s&&!t&&(l=a.return)&&(yield eL(l.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&et(n,["instances[]","content"],ed(e,i));let r=en(t,["config"]);return null!=r&&et(n,["config"],function(e,t,n){let l=en(t,["taskType"]);void 0!==n&&null!=l&&et(n,["instances[]","task_type"],l);let i=en(t,["title"]);void 0!==n&&null!=i&&et(n,["instances[]","title"],i);let r=en(t,["outputDimensionality"]);void 0!==n&&null!=r&&et(n,["parameters","outputDimensionality"],r);let o=en(t,["mimeType"]);void 0!==n&&null!=o&&et(n,["instances[]","mimeType"],o);let s=en(t,["autoTruncate"]);return void 0!==n&&null!=s&&et(n,["parameters","autoTruncate"],s),{}}(0,r,n)),n}(this.apiClient,e);return l=ee("{model}:predict",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["predictions[]","embeddings"]);null!=l&&(Array.isArray(l)?et(n,["embeddings"],l.map(e=>(function(e,t){let n={},l=en(t,["values"]);null!=l&&et(n,["values"],l);let i=en(t,["statistics"]);return null!=i&&et(n,["statistics"],function(e,t){let n={},l=en(t,["truncated"]);null!=l&&et(n,["truncated"],l);let i=en(t,["token_count"]);return null!=i&&et(n,["tokenCount"],i),n}(0,i)),n})(0,e))):et(n,["embeddings"],l));let i=en(t,["metadata"]);return null!=i&&et(n,["metadata"],function(e,t){let n={},l=en(t,["billableCharacterCount"]);return null!=l&&et(n,["billableCharacterCount"],l),n}(0,i)),n}(this.apiClient,e),n=new eO;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&et(n,["requests[]","content"],ed(e,i));let r=en(t,["config"]);null!=r&&et(n,["config"],function(e,t,n){let l=en(t,["taskType"]);void 0!==n&&null!=l&&et(n,["requests[]","taskType"],l);let i=en(t,["title"]);void 0!==n&&null!=i&&et(n,["requests[]","title"],i);let r=en(t,["outputDimensionality"]);if(void 0!==n&&null!=r&&et(n,["requests[]","outputDimensionality"],r),void 0!==en(t,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==en(t,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(0,r,n));let o=en(t,["model"]);return void 0!==o&&et(n,["requests[]","model"],el(e,o)),n}(this.apiClient,e);return l=ee("{model}:batchEmbedContents",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["embeddings"]);null!=l&&(Array.isArray(l)?et(n,["embeddings"],l.map(e=>(function(e,t){let n={},l=en(t,["values"]);return null!=l&&et(n,["values"],l),n})(0,e))):et(n,["embeddings"],l));let i=en(t,["metadata"]);return null!=i&&et(n,["metadata"],{}),n}(this.apiClient,e),n=new eO;return Object.assign(n,t),n})}}async generateImages(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["prompt"]);null!=i&&et(n,["instances[0]","prompt"],i);let r=en(t,["config"]);return null!=r&&et(n,["config"],function(e,t,n){let l=en(t,["outputGcsUri"]);void 0!==n&&null!=l&&et(n,["parameters","storageUri"],l);let i=en(t,["negativePrompt"]);void 0!==n&&null!=i&&et(n,["parameters","negativePrompt"],i);let r=en(t,["numberOfImages"]);void 0!==n&&null!=r&&et(n,["parameters","sampleCount"],r);let o=en(t,["aspectRatio"]);void 0!==n&&null!=o&&et(n,["parameters","aspectRatio"],o);let s=en(t,["guidanceScale"]);void 0!==n&&null!=s&&et(n,["parameters","guidanceScale"],s);let a=en(t,["seed"]);void 0!==n&&null!=a&&et(n,["parameters","seed"],a);let u=en(t,["safetyFilterLevel"]);void 0!==n&&null!=u&&et(n,["parameters","safetySetting"],u);let p=en(t,["personGeneration"]);void 0!==n&&null!=p&&et(n,["parameters","personGeneration"],p);let d=en(t,["includeSafetyAttributes"]);void 0!==n&&null!=d&&et(n,["parameters","includeSafetyAttributes"],d);let c=en(t,["includeRaiReason"]);void 0!==n&&null!=c&&et(n,["parameters","includeRaiReason"],c);let h=en(t,["language"]);void 0!==n&&null!=h&&et(n,["parameters","language"],h);let f=en(t,["outputMimeType"]);void 0!==n&&null!=f&&et(n,["parameters","outputOptions","mimeType"],f);let m=en(t,["outputCompressionQuality"]);void 0!==n&&null!=m&&et(n,["parameters","outputOptions","compressionQuality"],m);let g=en(t,["addWatermark"]);void 0!==n&&null!=g&&et(n,["parameters","addWatermark"],g);let y=en(t,["enhancePrompt"]);return void 0!==n&&null!=y&&et(n,["parameters","enhancePrompt"],y),{}}(0,r,n)),n}(this.apiClient,e);return l=ee("{model}:predict",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["predictions"]);return null!=l&&(Array.isArray(l)?et(n,["generatedImages"],l.map(t=>(function(e,t){let n={},l=en(t,["_self"]);null!=l&&et(n,["image"],function(e,t){let n={},l=en(t,["gcsUri"]);null!=l&&et(n,["gcsUri"],l);let i=en(t,["bytesBase64Encoded"]);null!=i&&et(n,["imageBytes"],eC(e,i));let r=en(t,["mimeType"]);return null!=r&&et(n,["mimeType"],r),n}(e,l));let i=en(t,["raiFilteredReason"]);null!=i&&et(n,["raiFilteredReason"],i);let r=en(t,["prompt"]);return null!=r&&et(n,["enhancedPrompt"],r),n})(e,t))):et(n,["generatedImages"],l)),n}(this.apiClient,e),n=new eI;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["prompt"]);null!=i&&et(n,["instances[0]","prompt"],i);let r=en(t,["config"]);return null!=r&&et(n,["config"],function(e,t,n){if(void 0!==en(t,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==en(t,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let l=en(t,["numberOfImages"]);void 0!==n&&null!=l&&et(n,["parameters","sampleCount"],l);let i=en(t,["aspectRatio"]);void 0!==n&&null!=i&&et(n,["parameters","aspectRatio"],i);let r=en(t,["guidanceScale"]);if(void 0!==n&&null!=r&&et(n,["parameters","guidanceScale"],r),void 0!==en(t,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let o=en(t,["safetyFilterLevel"]);void 0!==n&&null!=o&&et(n,["parameters","safetySetting"],o);let s=en(t,["personGeneration"]);void 0!==n&&null!=s&&et(n,["parameters","personGeneration"],s);let a=en(t,["includeSafetyAttributes"]);void 0!==n&&null!=a&&et(n,["parameters","includeSafetyAttributes"],a);let u=en(t,["includeRaiReason"]);void 0!==n&&null!=u&&et(n,["parameters","includeRaiReason"],u);let p=en(t,["language"]);void 0!==n&&null!=p&&et(n,["parameters","language"],p);let d=en(t,["outputMimeType"]);void 0!==n&&null!=d&&et(n,["parameters","outputOptions","mimeType"],d);let c=en(t,["outputCompressionQuality"]);if(void 0!==n&&null!=c&&et(n,["parameters","outputOptions","compressionQuality"],c),void 0!==en(t,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==en(t,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(0,r,n)),n}(this.apiClient,e);return l=ee("{model}:predict",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["predictions"]);return null!=l&&(Array.isArray(l)?et(n,["generatedImages"],l.map(t=>(function(e,t){let n={},l=en(t,["_self"]);null!=l&&et(n,["image"],function(e,t){let n={},l=en(t,["bytesBase64Encoded"]);null!=l&&et(n,["imageBytes"],eC(e,l));let i=en(t,["mimeType"]);return null!=i&&et(n,["mimeType"],i),n}(e,l));let i=en(t,["raiFilteredReason"]);return null!=i&&et(n,["raiFilteredReason"],i),n})(e,t))):et(n,["generatedImages"],l)),n}(this.apiClient,e),n=new eI;return Object.assign(n,t),n})}}async countTokens(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&(Array.isArray(i)?et(n,["contents"],eh(e,eh(e,i).map(t=>eV(e,t)))):et(n,["contents"],eh(e,i)));let r=en(t,["config"]);return null!=r&&et(n,["config"],function(e,t,n){let l=en(t,["systemInstruction"]);void 0!==n&&null!=l&&et(n,["systemInstruction"],eV(e,ep(e,l)));let i=en(t,["tools"]);void 0!==n&&null!=i&&(Array.isArray(i)?et(n,["tools"],i.map(t=>eK(e,t))):et(n,["tools"],i));let r=en(t,["generationConfig"]);return void 0!==n&&null!=r&&et(n,["generationConfig"],r),{}}(e,r,n)),n}(this.apiClient,e);return l=ee("{model}:countTokens",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["totalTokens"]);return null!=l&&et(n,["totalTokens"],l),n}(this.apiClient,e),n=new eA;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&(Array.isArray(i)?et(n,["contents"],eh(e,eh(e,i).map(t=>eF(e,t)))):et(n,["contents"],eh(e,i)));let r=en(t,["config"]);return null!=r&&et(n,["config"],function(e,t){if(void 0!==en(t,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==en(t,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==en(t,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.");return{}}(0,r)),n}(this.apiClient,e);return l=ee("{model}:countTokens",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["totalTokens"]);null!=l&&et(n,["totalTokens"],l);let i=en(t,["cachedContentTokenCount"]);return null!=i&&et(n,["cachedContentTokenCount"],i),n}(this.apiClient,e),n=new eA;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&(Array.isArray(i)?et(n,["contents"],eh(e,eh(e,i).map(t=>eV(e,t)))):et(n,["contents"],eh(e,i)));let r=en(t,["config"]);return null!=r&&et(n,["config"],r),n}(this.apiClient,e);return l=ee("{model}:computeTokens",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["tokensInfo"]);return null!=l&&et(n,["tokensInfo"],l),n}(this.apiClient,e),n=new e_;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["model"]);if(null!=l&&et(n,["_url","model"],el(e,l)),void 0!==en(t,["contents"]))throw Error("contents parameter is not supported in Gemini API.");let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("None",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["tokensInfo"]);return null!=l&&et(n,["tokensInfo"],l),n}(this.apiClient,e),n=new e_;return Object.assign(n,t),n})}}}function eF(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={};if(void 0!==en(t,["videoMetadata"]))throw Error("videoMetadata parameter is not supported in Gemini API.");let l=en(t,["thought"]);null!=l&&et(n,["thought"],l);let i=en(t,["codeExecutionResult"]);null!=i&&et(n,["codeExecutionResult"],i);let r=en(t,["executableCode"]);null!=r&&et(n,["executableCode"],r);let o=en(t,["fileData"]);null!=o&&et(n,["fileData"],o);let s=en(t,["functionCall"]);null!=s&&et(n,["functionCall"],s);let a=en(t,["functionResponse"]);null!=a&&et(n,["functionResponse"],a);let u=en(t,["inlineData"]);null!=u&&et(n,["inlineData"],u);let p=en(t,["text"]);return null!=p&&et(n,["text"],p),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function eV(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={},l=en(t,["videoMetadata"]);null!=l&&et(n,["videoMetadata"],l);let i=en(t,["thought"]);null!=i&&et(n,["thought"],i);let r=en(t,["codeExecutionResult"]);null!=r&&et(n,["codeExecutionResult"],r);let o=en(t,["executableCode"]);null!=o&&et(n,["executableCode"],o);let s=en(t,["fileData"]);null!=s&&et(n,["fileData"],s);let a=en(t,["functionCall"]);null!=a&&et(n,["functionCall"],a);let u=en(t,["functionResponse"]);null!=u&&et(n,["functionResponse"],u);let p=en(t,["inlineData"]);null!=p&&et(n,["inlineData"],p);let d=en(t,["text"]);return null!=d&&et(n,["text"],d),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function ek(e,t){let n={},l=en(t,["example"]);null!=l&&et(n,["example"],l);let i=en(t,["pattern"]);null!=i&&et(n,["pattern"],i);let r=en(t,["minimum"]);null!=r&&et(n,["minimum"],r);let o=en(t,["default"]);null!=o&&et(n,["default"],o);let s=en(t,["anyOf"]);null!=s&&et(n,["anyOf"],s);let a=en(t,["maxLength"]);null!=a&&et(n,["maxLength"],a);let u=en(t,["title"]);null!=u&&et(n,["title"],u);let p=en(t,["minLength"]);null!=p&&et(n,["minLength"],p);let d=en(t,["minProperties"]);null!=d&&et(n,["minProperties"],d);let c=en(t,["maximum"]);null!=c&&et(n,["maximum"],c);let h=en(t,["maxProperties"]);null!=h&&et(n,["maxProperties"],h);let f=en(t,["description"]);null!=f&&et(n,["description"],f);let m=en(t,["enum"]);null!=m&&et(n,["enum"],m);let g=en(t,["format"]);null!=g&&et(n,["format"],g);let y=en(t,["items"]);null!=y&&et(n,["items"],y);let C=en(t,["maxItems"]);null!=C&&et(n,["maxItems"],C);let v=en(t,["minItems"]);null!=v&&et(n,["minItems"],v);let E=en(t,["nullable"]);null!=E&&et(n,["nullable"],E);let O=en(t,["properties"]);null!=O&&et(n,["properties"],O);let I=en(t,["propertyOrdering"]);null!=I&&et(n,["propertyOrdering"],I);let A=en(t,["required"]);null!=A&&et(n,["required"],A);let _=en(t,["type"]);return null!=_&&et(n,["type"],_),n}function eY(e,t){let n={},l=en(t,["functionDeclarations"]);if(null!=l&&(Array.isArray(l)?et(n,["functionDeclarations"],l.map(e=>(function(e,t){let n={};if(void 0!==en(t,["response"]))throw Error("response parameter is not supported in Gemini API.");let l=en(t,["description"]);null!=l&&et(n,["description"],l);let i=en(t,["name"]);null!=i&&et(n,["name"],i);let r=en(t,["parameters"]);return null!=r&&et(n,["parameters"],r),n})(0,e))):et(n,["functionDeclarations"],l)),void 0!==en(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=en(t,["googleSearch"]);null!=i&&et(n,["googleSearch"],{});let r=en(t,["googleSearchRetrieval"]);null!=r&&et(n,["googleSearchRetrieval"],function(e,t){let n={},l=en(t,["dynamicRetrievalConfig"]);return null!=l&&et(n,["dynamicRetrievalConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["dynamicThreshold"]);return null!=i&&et(n,["dynamicThreshold"],i),n}(0,l)),n}(0,r));let o=en(t,["codeExecution"]);return null!=o&&et(n,["codeExecution"],o),n}function eK(e,t){let n={},l=en(t,["functionDeclarations"]);null!=l&&(Array.isArray(l)?et(n,["functionDeclarations"],l.map(t=>(function(e,t){let n={},l=en(t,["response"]);null!=l&&et(n,["response"],ek(e,l));let i=en(t,["description"]);null!=i&&et(n,["description"],i);let r=en(t,["name"]);null!=r&&et(n,["name"],r);let o=en(t,["parameters"]);return null!=o&&et(n,["parameters"],o),n})(e,t))):et(n,["functionDeclarations"],l));let i=en(t,["retrieval"]);null!=i&&et(n,["retrieval"],i);let r=en(t,["googleSearch"]);null!=r&&et(n,["googleSearch"],{});let o=en(t,["googleSearchRetrieval"]);null!=o&&et(n,["googleSearchRetrieval"],function(e,t){let n={},l=en(t,["dynamicRetrievalConfig"]);return null!=l&&et(n,["dynamicRetrievalConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["dynamicThreshold"]);return null!=i&&et(n,["dynamicThreshold"],i),n}(0,l)),n}(0,o));let s=en(t,["codeExecution"]);return null!=s&&et(n,["codeExecution"],s),n}function eJ(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&(Array.isArray(i)?et(n,["contents"],eh(e,eh(e,i).map(t=>eF(e,t)))):et(n,["contents"],eh(e,i)));let r=en(t,["config"]);return null!=r&&et(n,["generationConfig"],function(e,t,n){let l={},i=en(t,["systemInstruction"]);void 0!==n&&null!=i&&et(n,["systemInstruction"],eF(e,ep(e,i)));let r=en(t,["temperature"]);null!=r&&et(l,["temperature"],r);let o=en(t,["topP"]);null!=o&&et(l,["topP"],o);let s=en(t,["topK"]);null!=s&&et(l,["topK"],s);let a=en(t,["candidateCount"]);null!=a&&et(l,["candidateCount"],a);let u=en(t,["maxOutputTokens"]);null!=u&&et(l,["maxOutputTokens"],u);let p=en(t,["stopSequences"]);null!=p&&et(l,["stopSequences"],p);let d=en(t,["responseLogprobs"]);null!=d&&et(l,["responseLogprobs"],d);let c=en(t,["logprobs"]);null!=c&&et(l,["logprobs"],c);let h=en(t,["presencePenalty"]);null!=h&&et(l,["presencePenalty"],h);let f=en(t,["frequencyPenalty"]);null!=f&&et(l,["frequencyPenalty"],f);let m=en(t,["seed"]);null!=m&&et(l,["seed"],m);let g=en(t,["responseMimeType"]);null!=g&&et(l,["responseMimeType"],g);let y=en(t,["responseSchema"]);if(null!=y&&et(l,["responseSchema"],function(e,t){let n={};if(void 0!==en(t,["example"]))throw Error("example parameter is not supported in Gemini API.");if(void 0!==en(t,["pattern"]))throw Error("pattern parameter is not supported in Gemini API.");if(void 0!==en(t,["minimum"]))throw Error("minimum parameter is not supported in Gemini API.");if(void 0!==en(t,["default"]))throw Error("default parameter is not supported in Gemini API.");if(void 0!==en(t,["anyOf"]))throw Error("anyOf parameter is not supported in Gemini API.");if(void 0!==en(t,["maxLength"]))throw Error("maxLength parameter is not supported in Gemini API.");if(void 0!==en(t,["title"]))throw Error("title parameter is not supported in Gemini API.");if(void 0!==en(t,["minLength"]))throw Error("minLength parameter is not supported in Gemini API.");if(void 0!==en(t,["minProperties"]))throw Error("minProperties parameter is not supported in Gemini API.");if(void 0!==en(t,["maximum"]))throw Error("maximum parameter is not supported in Gemini API.");if(void 0!==en(t,["maxProperties"]))throw Error("maxProperties parameter is not supported in Gemini API.");let l=en(t,["description"]);null!=l&&et(n,["description"],l);let i=en(t,["enum"]);null!=i&&et(n,["enum"],i);let r=en(t,["format"]);null!=r&&et(n,["format"],r);let o=en(t,["items"]);null!=o&&et(n,["items"],o);let s=en(t,["maxItems"]);null!=s&&et(n,["maxItems"],s);let a=en(t,["minItems"]);null!=a&&et(n,["minItems"],a);let u=en(t,["nullable"]);null!=u&&et(n,["nullable"],u);let p=en(t,["properties"]);null!=p&&et(n,["properties"],p);let d=en(t,["propertyOrdering"]);null!=d&&et(n,["propertyOrdering"],d);let c=en(t,["required"]);null!=c&&et(n,["required"],c);let h=en(t,["type"]);return null!=h&&et(n,["type"],h),n}(0,ef(e,y))),void 0!==en(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");let C=en(t,["safetySettings"]);void 0!==n&&null!=C&&(Array.isArray(C)?et(n,["safetySettings"],C.map(e=>(function(e,t){let n={};if(void 0!==en(t,["method"]))throw Error("method parameter is not supported in Gemini API.");let l=en(t,["category"]);null!=l&&et(n,["category"],l);let i=en(t,["threshold"]);return null!=i&&et(n,["threshold"],i),n})(0,e))):et(n,["safetySettings"],C));let v=en(t,["tools"]);void 0!==n&&null!=v&&(Array.isArray(v)?et(n,["tools"],eg(e,eg(e,v).map(t=>eY(e,t)))):et(n,["tools"],eg(e,v)));let E=en(t,["toolConfig"]);if(void 0!==n&&null!=E&&et(n,["toolConfig"],function(e,t){let n={},l=en(t,["functionCallingConfig"]);return null!=l&&et(n,["functionCallingConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["allowedFunctionNames"]);return null!=i&&et(n,["allowedFunctionNames"],i),n}(0,l)),n}(0,E)),void 0!==en(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let O=en(t,["cachedContent"]);void 0!==n&&null!=O&&et(n,["cachedContent"],ey(e,O));let I=en(t,["responseModalities"]);null!=I&&et(l,["responseModalities"],I);let A=en(t,["mediaResolution"]);null!=A&&et(l,["mediaResolution"],A);let _=en(t,["speechConfig"]);if(null!=_&&et(l,["speechConfig"],function(e,t){let n={},l=en(t,["voiceConfig"]);return null!=l&&et(n,["voiceConfig"],function(e,t){let n={},l=en(t,["prebuiltVoiceConfig"]);return null!=l&&et(n,["prebuiltVoiceConfig"],function(e,t){let n={},l=en(t,["voiceName"]);return null!=l&&et(n,["voiceName"],l),n}(0,l)),n}(0,l)),n}(0,em(e,_))),void 0!==en(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let T=en(t,["thinkingConfig"]);return null!=T&&et(l,["thinkingConfig"],function(e,t){let n={},l=en(t,["includeThoughts"]);return null!=l&&et(n,["includeThoughts"],l),n}(0,T)),l}(e,r,n)),n}function e$(e,t){let n={},l=en(t,["model"]);null!=l&&et(n,["_url","model"],el(e,l));let i=en(t,["contents"]);null!=i&&(Array.isArray(i)?et(n,["contents"],eh(e,eh(e,i).map(t=>eV(e,t)))):et(n,["contents"],eh(e,i)));let r=en(t,["config"]);return null!=r&&et(n,["generationConfig"],function(e,t,n){let l={},i=en(t,["systemInstruction"]);void 0!==n&&null!=i&&et(n,["systemInstruction"],eV(e,ep(e,i)));let r=en(t,["temperature"]);null!=r&&et(l,["temperature"],r);let o=en(t,["topP"]);null!=o&&et(l,["topP"],o);let s=en(t,["topK"]);null!=s&&et(l,["topK"],s);let a=en(t,["candidateCount"]);null!=a&&et(l,["candidateCount"],a);let u=en(t,["maxOutputTokens"]);null!=u&&et(l,["maxOutputTokens"],u);let p=en(t,["stopSequences"]);null!=p&&et(l,["stopSequences"],p);let d=en(t,["responseLogprobs"]);null!=d&&et(l,["responseLogprobs"],d);let c=en(t,["logprobs"]);null!=c&&et(l,["logprobs"],c);let h=en(t,["presencePenalty"]);null!=h&&et(l,["presencePenalty"],h);let f=en(t,["frequencyPenalty"]);null!=f&&et(l,["frequencyPenalty"],f);let m=en(t,["seed"]);null!=m&&et(l,["seed"],m);let g=en(t,["responseMimeType"]);null!=g&&et(l,["responseMimeType"],g);let y=en(t,["responseSchema"]);null!=y&&et(l,["responseSchema"],ek(e,ef(e,y)));let C=en(t,["routingConfig"]);null!=C&&et(l,["routingConfig"],C);let v=en(t,["safetySettings"]);void 0!==n&&null!=v&&(Array.isArray(v)?et(n,["safetySettings"],v.map(e=>(function(e,t){let n={},l=en(t,["method"]);null!=l&&et(n,["method"],l);let i=en(t,["category"]);null!=i&&et(n,["category"],i);let r=en(t,["threshold"]);return null!=r&&et(n,["threshold"],r),n})(0,e))):et(n,["safetySettings"],v));let E=en(t,["tools"]);void 0!==n&&null!=E&&(Array.isArray(E)?et(n,["tools"],eg(e,eg(e,E).map(t=>eK(e,t)))):et(n,["tools"],eg(e,E)));let O=en(t,["toolConfig"]);void 0!==n&&null!=O&&et(n,["toolConfig"],function(e,t){let n={},l=en(t,["functionCallingConfig"]);return null!=l&&et(n,["functionCallingConfig"],function(e,t){let n={},l=en(t,["mode"]);null!=l&&et(n,["mode"],l);let i=en(t,["allowedFunctionNames"]);return null!=i&&et(n,["allowedFunctionNames"],i),n}(0,l)),n}(0,O));let I=en(t,["labels"]);void 0!==n&&null!=I&&et(n,["labels"],I);let A=en(t,["cachedContent"]);void 0!==n&&null!=A&&et(n,["cachedContent"],ey(e,A));let _=en(t,["responseModalities"]);null!=_&&et(l,["responseModalities"],_);let T=en(t,["mediaResolution"]);null!=T&&et(l,["mediaResolution"],T);let S=en(t,["speechConfig"]);null!=S&&et(l,["speechConfig"],function(e,t){let n={},l=en(t,["voiceConfig"]);return null!=l&&et(n,["voiceConfig"],function(e,t){let n={},l=en(t,["prebuiltVoiceConfig"]);return null!=l&&et(n,["prebuiltVoiceConfig"],function(e,t){let n={},l=en(t,["voiceName"]);return null!=l&&et(n,["voiceName"],l),n}(0,l)),n}(0,l)),n}(0,em(e,S)));let P=en(t,["audioTimestamp"]);null!=P&&et(l,["audioTimestamp"],P);let b=en(t,["thinkingConfig"]);return null!=b&&et(l,["thinkingConfig"],function(e,t){let n={},l=en(t,["includeThoughts"]);return null!=l&&et(n,["includeThoughts"],l),n}(0,b)),l}(e,r,n)),n}function eW(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={},l=en(t,["thought"]);null!=l&&et(n,["thought"],l);let i=en(t,["codeExecutionResult"]);null!=i&&et(n,["codeExecutionResult"],i);let r=en(t,["executableCode"]);null!=r&&et(n,["executableCode"],r);let o=en(t,["fileData"]);null!=o&&et(n,["fileData"],o);let s=en(t,["functionCall"]);null!=s&&et(n,["functionCall"],s);let a=en(t,["functionResponse"]);null!=a&&et(n,["functionResponse"],a);let u=en(t,["inlineData"]);null!=u&&et(n,["inlineData"],u);let p=en(t,["text"]);return null!=p&&et(n,["text"],p),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function ez(e,t){let n={},l=en(t,["parts"]);null!=l&&(Array.isArray(l)?et(n,["parts"],l.map(e=>(function(e,t){let n={},l=en(t,["videoMetadata"]);null!=l&&et(n,["videoMetadata"],l);let i=en(t,["thought"]);null!=i&&et(n,["thought"],i);let r=en(t,["codeExecutionResult"]);null!=r&&et(n,["codeExecutionResult"],r);let o=en(t,["executableCode"]);null!=o&&et(n,["executableCode"],o);let s=en(t,["fileData"]);null!=s&&et(n,["fileData"],s);let a=en(t,["functionCall"]);null!=a&&et(n,["functionCall"],a);let u=en(t,["functionResponse"]);null!=u&&et(n,["functionResponse"],u);let p=en(t,["inlineData"]);null!=p&&et(n,["inlineData"],p);let d=en(t,["text"]);return null!=d&&et(n,["text"],d),n})(0,e))):et(n,["parts"],l));let i=en(t,["role"]);return null!=i&&et(n,["role"],i),n}function eX(e,t){let n={},l=en(t,["candidates"]);null!=l&&(Array.isArray(l)?et(n,["candidates"],l.map(t=>(function(e,t){let n={},l=en(t,["content"]);null!=l&&et(n,["content"],eW(e,l));let i=en(t,["citationMetadata"]);null!=i&&et(n,["citationMetadata"],function(e,t){let n={},l=en(t,["citationSources"]);return null!=l&&et(n,["citations"],l),n}(0,i));let r=en(t,["tokenCount"]);null!=r&&et(n,["tokenCount"],r);let o=en(t,["avgLogprobs"]);null!=o&&et(n,["avgLogprobs"],o);let s=en(t,["finishReason"]);null!=s&&et(n,["finishReason"],s);let a=en(t,["groundingMetadata"]);null!=a&&et(n,["groundingMetadata"],a);let u=en(t,["index"]);null!=u&&et(n,["index"],u);let p=en(t,["logprobsResult"]);null!=p&&et(n,["logprobsResult"],p);let d=en(t,["safetyRatings"]);return null!=d&&et(n,["safetyRatings"],d),n})(e,t))):et(n,["candidates"],l));let i=en(t,["modelVersion"]);null!=i&&et(n,["modelVersion"],i);let r=en(t,["promptFeedback"]);null!=r&&et(n,["promptFeedback"],r);let o=en(t,["usageMetadata"]);return null!=o&&et(n,["usageMetadata"],o),n}function eQ(e,t){let n={},l=en(t,["candidates"]);null!=l&&(Array.isArray(l)?et(n,["candidates"],l.map(t=>(function(e,t){let n={},l=en(t,["content"]);null!=l&&et(n,["content"],ez(e,l));let i=en(t,["citationMetadata"]);null!=i&&et(n,["citationMetadata"],function(e,t){let n={},l=en(t,["citations"]);return null!=l&&et(n,["citations"],l),n}(0,i));let r=en(t,["finishMessage"]);null!=r&&et(n,["finishMessage"],r);let o=en(t,["avgLogprobs"]);null!=o&&et(n,["avgLogprobs"],o);let s=en(t,["finishReason"]);null!=s&&et(n,["finishReason"],s);let a=en(t,["groundingMetadata"]);null!=a&&et(n,["groundingMetadata"],a);let u=en(t,["index"]);null!=u&&et(n,["index"],u);let p=en(t,["logprobsResult"]);null!=p&&et(n,["logprobsResult"],p);let d=en(t,["safetyRatings"]);return null!=d&&et(n,["safetyRatings"],d),n})(e,t))):et(n,["candidates"],l));let i=en(t,["createTime"]);null!=i&&et(n,["createTime"],i);let r=en(t,["responseId"]);null!=r&&et(n,["responseId"],r);let o=en(t,["modelVersion"]);null!=o&&et(n,["modelVersion"],o);let s=en(t,["promptFeedback"]);null!=s&&et(n,["promptFeedback"],s);let a=en(t,["usageMetadata"]);return null!=a&&et(n,["usageMetadata"],a),n}async function eZ(e,t,n){let l;l=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),t(e.isVertexAI()?function(e,t){let n={},l=en(t,["setupComplete"]);void 0!==l&&et(n,["setupComplete"],l);let i=en(t,["serverContent"]);null!=i&&et(n,["serverContent"],function(e,t){let n={},l=en(t,["modelTurn"]);null!=l&&et(n,["modelTurn"],ez(e,l));let i=en(t,["turnComplete"]);void 0!==i&&et(n,["turnComplete"],i);let r=en(t,["interrupted"]);return void 0!==r&&et(n,["interrupted"],r),n}(e,i));let r=en(t,["toolCall"]);null!=r&&et(n,["toolCall"],function(e,t){let n={},l=en(t,["functionCalls"]);return null!=l&&Array.isArray(l)&&et(n,["functionCalls"],l.map(e=>(function(e,t){let n={},l=en(t,["args"]);void 0!==l&&et(n,["args"],l);let i=en(t,["name"]);return void 0!==i&&et(n,["name"],i),n})(0,e))),n}(0,r));let o=en(t,["toolCallCancellation"]);return null!=o&&et(n,["toolCallCancellation"],function(e,t){let n={},l=en(t,["ids"]);return void 0!==l&&et(n,["ids"],l),n}(0,o)),n}(e,l):function(e,t){let n={},l=en(t,["setupComplete"]);void 0!==l&&et(n,["setupComplete"],l);let i=en(t,["serverContent"]);null!=i&&et(n,["serverContent"],function(e,t){let n={},l=en(t,["modelTurn"]);null!=l&&et(n,["modelTurn"],eW(e,l));let i=en(t,["turnComplete"]);void 0!==i&&et(n,["turnComplete"],i);let r=en(t,["interrupted"]);return void 0!==r&&et(n,["interrupted"],r),n}(e,i));let r=en(t,["toolCall"]);null!=r&&et(n,["toolCall"],function(e,t){let n={},l=en(t,["functionCalls"]);return null!=l&&Array.isArray(l)&&et(n,["functionCalls"],l.map(e=>(function(e,t){let n={},l=en(t,["id"]);void 0!==l&&et(n,["id"],l);let i=en(t,["args"]);void 0!==i&&et(n,["args"],i);let r=en(t,["name"]);return void 0!==r&&et(n,["name"],r),n})(0,e))),n}(0,r));let o=en(t,["toolCallCancellation"]);return null!=o&&et(n,["toolCallCancellation"],function(e,t){let n={},l=en(t,["ids"]);return void 0!==l&&et(n,["ids"],l),n}(0,o)),n}(e,l))}class e0{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;let l;if(this.apiClient.isVertexAI())throw Error("This SDK does not yet support the live API for **Google Vertex AI**.");let i=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=function(e){let t=new Headers;for(let[n,l]of Object.entries(e))t.append(n,l);return t}(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())l=`${i}/ws/google.cloud.aiplatform.${r}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(o);else{let e=this.apiClient.getApiKey();l=`${i}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateContent?key=${e}`}let s=()=>{},a=new Promise(e=>{s=e}),u=e.callbacks,p=this.apiClient,d={onopen:function(){var e;null===(e=null==u?void 0:u.onopen)||void 0===e||e.call(u),s({})},onmessage:e=>{eZ(p,u.onmessage,e)},onerror:null!==(t=null==u?void 0:u.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==u?void 0:u.onclose)&&void 0!==n?n:function(e){}},c=this.webSocketFactory.create(l,function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(o),d);c.connect(),await a;let h=el(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&h.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();h=`projects/${e}/locations/${t}/`+h}let f={},m={model:h,config:e.config,callbacks:e.callbacks};return f=this.apiClient.isVertexAI()?function(e,t){let n={},l=en(t,["config"]);null!=l&&et(n,["setup"],function(e,t){let n={},l=en(t,["generationConfig"]);void 0!==l&&et(n,["generationConfig"],l);let i=en(t,["responseModalities"]);void 0!==i?et(n,["generationConfig","responseModalities"],i):et(n,["generationConfig","responseModalities"],["AUDIO"]);let r=en(t,["speechConfig"]);void 0!==r&&et(n,["generationConfig","speechConfig"],r);let o=en(t,["systemInstruction"]);null!=o&&et(n,["systemInstruction"],eV(e,o));let s=en(t,["tools"]);return null!=s&&Array.isArray(s)&&et(n,["tools"],s.map(t=>eK(e,t))),n}(e,l));let i=en(t,["model"]);return void 0!==i&&et(n,["setup","model"],i),n}(this.apiClient,m):function(e,t){let n={},l=en(t,["config"]);null!=l&&et(n,["setup"],function(e,t){let n={},l=en(t,["generationConfig"]);void 0!==l&&et(n,["generationConfig"],l);let i=en(t,["responseModalities"]);void 0!==i&&et(n,["generationConfig","responseModalities"],i);let r=en(t,["speechConfig"]);void 0!==r&&et(n,["generationConfig","speechConfig"],r);let o=en(t,["systemInstruction"]);null!=o&&et(n,["systemInstruction"],eF(e,o));let s=en(t,["tools"]);return null!=s&&Array.isArray(s)&&et(n,["tools"],s.map(t=>eY(e,t))),n}(e,l));let i=en(t,["model"]);return void 0!==i&&et(n,["setup","model"],i),n}(this.apiClient,m),c.send(JSON.stringify(f)),new e1(c,this.apiClient)}}class e1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=eh(e,t.turns),n=e.isVertexAI()?n.map(t=>eV(e,t)):n.map(t=>eF(e,t))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClientRealtimeInput(e,t){if(!("media"in t)||!t.media)throw Error(`Failed to convert realtime input "media", type: '${typeof t.media}'`);return{realtimeInput:{mediaChunks:[t.media]}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||(Array.isArray(t.functionResponses)||(n=[t.functionResponses]),0===n.length))throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}let l={toolResponse:{functionResponses:n}};return l}sendClientContent(e){null==e.turns&&null==e.turnComplete&&(e={turnComplete:!0});let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){if(null==e.media)throw Error("Media is required.");let t=this.tLiveClientRealtimeInput(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}let e2=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class e6 extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:Error().stack}),this.message=e,this.name="ClientError"}}class e5 extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:Error().stack}),this.message=e,this.name="ServerError"}}class e8{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let l={};this.clientOptions.vertexai?(l.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",l.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(l.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",l.baseUrl="https://generativelanguage.googleapis.com/"),l.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=l,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(l,e.httpOptions))}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl,n=[t];return e.apiVersion&&""!==e.apiVersion&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol="wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t){let n=[this.getRequestUrlInternal(t)];this.clientOptions.vertexai&&!e.startsWith("projects/")&&n.push(this.getBaseResourcePath()),""!==e&&n.push(e);let l=new URL(`${n.join("/")}`);return l}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.constructUrl(e.path,t);if(e.queryParams)for(let[t,l]of Object.entries(e.queryParams))n.searchParams.append(t,String(l));let l={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t),this.unaryApiCall(n,l,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,l]of Object.entries(t))"object"==typeof l?n[e]=Object.assign(Object.assign({},n[e]),l):void 0!==l&&(n[e]=l);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.constructUrl(e.path,t);n.searchParams.has("alt")&&"sse"===n.searchParams.get("alt")||n.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t),this.streamApiCall(n,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t){if(t&&t.timeout&&t.timeout>0){let n=new AbortController,l=n.signal;setTimeout(()=>n.abort(),t.timeout),e.signal=l}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async t=>(await e3(t,e.toString()),new eb(t))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async t=>(await e3(t,e.toString()),this.processStreamResponse(t))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return eq(this,arguments,function*(){let n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let e="";for(;;){let{done:t,value:i}=yield eL(n.read());if(t){if(e.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let r=l.decode(i),o=(e+=r).match(e2);for(;o;){let t=o[1];try{let n=JSON.parse(t);yield yield eL(n),o=(e=e.slice(o[0].length)).match(e2)}catch(e){throw Error(`exception parsing stream chunk ${t}. ${e}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/0.2.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e["x-goog-api-client"]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){let t=new Headers;if(e&&e.headers)for(let[n,l]of Object.entries(e.headers))t.append(n,l);return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;let l={};null!=t&&(l.mimeType=t.mimeType,l.name=t.name,l.displayName=t.displayName),l.name&&!l.name.startsWith("files/")&&(l.name=`files/${l.name}`);let i=this.clientOptions.uploader,r=await i.stat(e);l.sizeBytes=r.size;let o=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:r.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=o;let s=await this.fetchUploadUrl(l,t);return i.upload(e,s,this)}async fetchUploadUrl(e,t){var n;let l={};l=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};let i={file:e},r=await this.request({path:ee("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!r||!(null==r?void 0:r.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let o=null===(n=null==r?void 0:r.headers)||void 0===n?void 0:n["x-goog-upload-url"];if(void 0===o)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}}async function e3(e,t,n){var l;if(void 0===e)throw new e5("response is undefined");if(!e.ok){let t;let n=e.status,i=e.statusText;t=(null===(l=e.headers.get("content-type"))||void 0===l?void 0:l.includes("application/json"))?await e.json():{error:{message:"exception parsing response",code:e.status,status:e.statusText}};let r=`got status: ${n} ${i}. ${JSON.stringify(t)}`;if(n>=400&&n<500){let e=new e6(r);throw e}if(n>=500&&n<600){let e=new e5(r);throw e}throw Error(r)}}/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class e4 extends Z{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ev(l.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e,t){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e,t).then(e=>{let t=e7(this.apiClient,e);return t})}async listInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){if(void 0!==en(t,["config"]))throw Error("config parameter is not supported in Vertex AI.");return{}}(this.apiClient,e);return l=ee("None",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{var t;let n=(this.apiClient,{}),l=new eP;return Object.assign(l,n),l})}{let t=function(e,t){let n={},l=en(t,["config"]);return null!=l&&et(n,["config"],function(e,t,n){let l=en(t,["pageSize"]);void 0!==n&&null!=l&&et(n,["_query","pageSize"],l);let i=en(t,["pageToken"]);return void 0!==n&&null!=i&&et(n,["_query","pageToken"],i),{}}(0,l,n)),n}(this.apiClient,e);return l=ee("files",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["nextPageToken"]);null!=l&&et(n,["nextPageToken"],l);let i=en(t,["files"]);return null!=i&&(Array.isArray(i)?et(n,["files"],i.map(t=>e7(e,t))):et(n,["files"],i)),n}(this.apiClient,e),n=new eP;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){if(void 0!==en(t,["file"]))throw Error("file parameter is not supported in Vertex AI.");if(void 0!==en(t,["config"]))throw Error("config parameter is not supported in Vertex AI.");return{}}(this.apiClient,e);return l=ee("",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["httpHeaders"]);return null!=l&&et(n,["httpHeaders"],l),n}(this.apiClient,e),n=new eR;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=en(t,["file"]);null!=l&&et(n,["file"],function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["name"],l);let i=en(t,["displayName"]);null!=i&&et(n,["displayName"],i);let r=en(t,["mimeType"]);null!=r&&et(n,["mimeType"],r);let o=en(t,["sizeBytes"]);null!=o&&et(n,["sizeBytes"],o);let s=en(t,["createTime"]);null!=s&&et(n,["createTime"],s);let a=en(t,["expirationTime"]);null!=a&&et(n,["expirationTime"],a);let u=en(t,["updateTime"]);null!=u&&et(n,["updateTime"],u);let p=en(t,["sha256Hash"]);null!=p&&et(n,["sha256Hash"],p);let d=en(t,["uri"]);null!=d&&et(n,["uri"],d);let c=en(t,["downloadUri"]);null!=c&&et(n,["downloadUri"],c);let h=en(t,["state"]);null!=h&&et(n,["state"],h);let f=en(t,["source"]);null!=f&&et(n,["source"],f);let m=en(t,["videoMetadata"]);null!=m&&et(n,["videoMetadata"],m);let g=en(t,["error"]);return null!=g&&et(n,["error"],function(e,t){let n={},l=en(t,["details"]);null!=l&&et(n,["details"],l);let i=en(t,["message"]);null!=i&&et(n,["message"],i);let r=en(t,["code"]);return null!=r&&et(n,["code"],r),n}(0,g)),n}(0,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("upload/v1beta/files",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},l=en(t,["httpHeaders"]);return null!=l&&et(n,["httpHeaders"],l),n}(this.apiClient,e),n=new eR;return Object.assign(n,t),n})}}async get(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let n=function(e,t){if(void 0!==en(t,["name"]))throw Error("name parameter is not supported in Vertex AI.");if(void 0!==en(t,["config"]))throw Error("config parameter is not supported in Vertex AI.");return{}}(this.apiClient,e);return l=ee("None",n._url),i=n._query,delete n.config,delete n._url,delete n._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions}).then(e=>e.json()).then(e=>{var t;let n=(this.apiClient,{});return n})}{let t=function(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["_url","file"],function(e,t){if("string"!=typeof t)throw Error("fromName must be a string");return t.startsWith("files/")?t.split("files/")[1]:t}(0,l));let i=en(t,["config"]);return null!=i&&et(n,["config"],i),n}(this.apiClient,e);return l=ee("files/{file}",t._url),i=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions}).then(e=>e.json()).then(e=>{let t=e7(this.apiClient,e);return t})}}}function e7(e,t){let n={},l=en(t,["name"]);null!=l&&et(n,["name"],l);let i=en(t,["displayName"]);null!=i&&et(n,["displayName"],i);let r=en(t,["mimeType"]);null!=r&&et(n,["mimeType"],r);let o=en(t,["sizeBytes"]);null!=o&&et(n,["sizeBytes"],o);let s=en(t,["createTime"]);null!=s&&et(n,["createTime"],s);let a=en(t,["expirationTime"]);null!=a&&et(n,["expirationTime"],a);let u=en(t,["updateTime"]);null!=u&&et(n,["updateTime"],u);let p=en(t,["sha256Hash"]);null!=p&&et(n,["sha256Hash"],p);let d=en(t,["uri"]);null!=d&&et(n,["uri"],d);let c=en(t,["downloadUri"]);null!=c&&et(n,["downloadUri"],c);let h=en(t,["state"]);null!=h&&et(n,["state"],h);let f=en(t,["source"]);null!=f&&et(n,["source"],f);let m=en(t,["videoMetadata"]);null!=m&&et(n,["videoMetadata"],m);let g=en(t,["error"]);return null!=g&&et(n,["error"],function(e,t){let n={},l=en(t,["details"]);null!=l&&et(n,["details"],l);let i=en(t,["message"]);null!=i&&et(n,["message"],i);let r=en(t,["code"]);return null!=r&&et(n,["code"],r),n}(0,g)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e9(){return Error(`This feature requires the web or Node specific @google/genai implementation, you can fix this by either:

*Enabling conditional exports for your project [recommended]*

*Using a platform specific import* - Make sure your code imports either '@google/genai/web' or '@google/genai/node' instead of '@google/genai'.
`)}class te{async upload(e,t,n){throw e9()}async stat(e){throw e9()}async uploadBlob(e,t,n){var l,i;let r=0,o=0,s=new eb(new Response),a="upload";for(r=e.size;o<r;){let i=Math.min(8388608,r-o),u=e.slice(o,o+i);if(o+i>=r&&(a+=", finalize"),s=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(o),"Content-Length":String(i)}}}),o+=i,(null===(l=null==s?void 0:s.headers)||void 0===l?void 0:l["x-goog-upload-status"])!=="active")break;if(r<=o)throw Error("All content has been uploaded, but the upload status is not finalized.")}let u=await (null==s?void 0:s.json());if((null===(i=null==s?void 0:s.headers)||void 0===i?void 0:i["x-goog-upload-status"])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return u.file}}class tt{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");let l=new te;return await l.uploadBlob(e,t,n)}async stat(e){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");{let t={size:e.size,type:e.type};return t}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tn{create(e,t,n){return new tl(e,t,n)}}class tl{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ti="x-goog-api-key";class tr{constructor(e){this.apiKey=e}async addAuthHeaders(e){null===e.get(ti)&&e.append(ti,this.apiKey)}}class to{constructor(e){var t;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey,this.apiVersion=e.apiVersion;let n=new tr(this.apiKey);this.apiClient=new e8({auth:n,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new tt}),this.models=new eB(this.apiClient),this.live=new e0(this.apiClient,n,new tn),this.chats=new eH(this.models,this.apiClient),this.caches=new eN(this.apiClient),this.files=new e4(this.apiClient)}}}}]);